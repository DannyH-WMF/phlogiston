#time python3 load_transactions_from_dump.py --verbose --report --project PHID-PROJ-e5pkst3uyzpxifwwj7qb,PHID-PROJ-nz5zs2camiseltyuemsj,PHID-PROJ-dafezmpv6huxg3taml24 --output VE-report.csv

wget http://dumps.wikimedia.org/other/misc/phabricator_public.dump

DROP TABLE IF EXISTS rep;

CREATE TABLE rep (
       date timestamp,
       ID varchar(30),
       title text,
       status varchar(20),
       project varchar(200),
       projectcolumn varchar(200),
       points int
);

copy rep from '/home/joel/phab/phab_task_history/VE-report.csv' delimiter ',' CSV HEADER;

select id, max(project) as project, max(points) as points into temp_points from rep group by id;


copy (select count(id), project, points from temp_points group by project, points order by project, points) to '/tmp/histogram.csv' csv header;


# burnup:
copy (select date, sum(points) from rep where status = '"resolved"' group by date order by date) to '/tmp/burnup.csv' delimiter ',' CSV HEADER;
